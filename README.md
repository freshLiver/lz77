# A Simple LZ77 Implementation

## Introduce

The original code is taken from [andyherbert/lz1](https://github.com/andyherbert/lz1), but apply some changes:

- Renaming
- Border checks during encoding
- Alignment problems

## Limitations

## Example

```shell
$ make -B TEST_FILE=/dev/zero
clang -std=c99 -g -O3 -Wall -Wextra -Werror -o lz.o -c lz.c
clang -std=c99 -g -O3 -Wall -Wextra -Werror -o test.o -c test.c
clang -o main lz.o test.o -fsanitize=undefined,leak,address,integer,implicit-conversion
Compressing 2 bytes... (input file size: 0)
        [01]: Compressed size 11 bytes
        [02]: Compressed size 11 bytes
        [03]: Compressed size 11 bytes
        [04]: Compressed size 11 bytes
        [05]: Compressed size 11 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 4 bytes... (input file size: 0)
        [01]: Compressed size 11 bytes
        [02]: Compressed size 11 bytes
        [03]: Compressed size 11 bytes
        [04]: Compressed size 11 bytes
        [05]: Compressed size 11 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 8 bytes... (input file size: 0)
        [01]: Compressed size 17 bytes
        [02]: Compressed size 14 bytes
        [03]: Compressed size 11 bytes
        [04]: Compressed size 11 bytes
        [05]: Compressed size 11 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 16 bytes... (input file size: 0)
        [01]: Compressed size 23 bytes
        [02]: Compressed size 17 bytes
        [03]: Compressed size 14 bytes
        [04]: Compressed size 11 bytes
        [05]: Compressed size 11 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 32 bytes... (input file size: 0)
        [01]: Compressed size 41 bytes
        [02]: Compressed size 29 bytes
        [03]: Compressed size 20 bytes
        [04]: Compressed size 14 bytes
        [05]: Compressed size 11 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 64 bytes... (input file size: 0)
        [01]: Compressed size 71 bytes
        [02]: Compressed size 47 bytes
        [03]: Compressed size 29 bytes
        [04]: Compressed size 20 bytes
        [05]: Compressed size 14 bytes
        [06]: Compressed size 11 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 128 bytes... (input file size: 0)
        [01]: Compressed size 137 bytes
        [02]: Compressed size 86 bytes
        [03]: Compressed size 53 bytes
        [04]: Compressed size 32 bytes
        [05]: Compressed size 20 bytes
        [06]: Compressed size 14 bytes
        [07]: Compressed size 11 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 256 bytes... (input file size: 0)
        [01]: Compressed size 263 bytes
        [02]: Compressed size 161 bytes
        [03]: Compressed size 95 bytes
        [04]: Compressed size 53 bytes
        [05]: Compressed size 32 bytes
        [06]: Compressed size 20 bytes
        [07]: Compressed size 14 bytes
        [08]: Compressed size 11 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 512 bytes... (input file size: 0)
        [01]: Compressed size 521 bytes
        [02]: Compressed size 317 bytes
        [03]: Compressed size 179 bytes
        [04]: Compressed size 101 bytes
        [05]: Compressed size 56 bytes
        [06]: Compressed size 32 bytes
        [07]: Compressed size 20 bytes
        [08]: Compressed size 14 bytes
        [09]: Compressed size 11 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 1024 bytes... (input file size: 0)
        [01]: Compressed size 1031 bytes
        [02]: Compressed size 623 bytes
        [03]: Compressed size 350 bytes
        [04]: Compressed size 191 bytes
        [05]: Compressed size 101 bytes
        [06]: Compressed size 56 bytes
        [07]: Compressed size 32 bytes
        [08]: Compressed size 20 bytes
        [09]: Compressed size 14 bytes
        [10]: Compressed size 11 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 2048 bytes... (input file size: 0)
        [01]: Compressed size 2057 bytes
        [02]: Compressed size 1238 bytes
        [03]: Compressed size 692 bytes
        [04]: Compressed size 371 bytes
        [05]: Compressed size 197 bytes
        [06]: Compressed size 104 bytes
        [07]: Compressed size 56 bytes
        [08]: Compressed size 32 bytes
        [09]: Compressed size 20 bytes
        [10]: Compressed size 14 bytes
        [11]: Compressed size 11 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 4096 bytes... (input file size: 0)
        [01]: Compressed size 4103 bytes
        [02]: Compressed size 2465 bytes
        [03]: Compressed size 1373 bytes
        [04]: Compressed size 731 bytes
        [05]: Compressed size 383 bytes
        [06]: Compressed size 197 bytes
        [07]: Compressed size 104 bytes
        [08]: Compressed size 56 bytes
        [09]: Compressed size 32 bytes
        [10]: Compressed size 20 bytes
        [11]: Compressed size 14 bytes
        [12]: Compressed size 11 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 8192 bytes... (input file size: 0)
        [01]: Compressed size 8201 bytes
        [02]: Compressed size 4925 bytes
        [03]: Compressed size 2741 bytes
        [04]: Compressed size 1454 bytes
        [05]: Compressed size 755 bytes
        [06]: Compressed size 389 bytes
        [07]: Compressed size 200 bytes
        [08]: Compressed size 104 bytes
        [09]: Compressed size 56 bytes
        [10]: Compressed size 32 bytes
        [11]: Compressed size 20 bytes
        [12]: Compressed size 14 bytes
        [13]: Compressed size 11 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 16384 bytes... (input file size: 0)
        [01]: Compressed size 16391 bytes
        [02]: Compressed size 9839 bytes
        [03]: Compressed size 5471 bytes
        [04]: Compressed size 2900 bytes
        [05]: Compressed size 1499 bytes
        [06]: Compressed size 767 bytes
        [07]: Compressed size 389 bytes
        [08]: Compressed size 200 bytes
        [09]: Compressed size 104 bytes
        [10]: Compressed size 56 bytes
        [11]: Compressed size 32 bytes
        [12]: Compressed size 20 bytes
        [13]: Compressed size 14 bytes
        [14]: Compressed size 11 bytes
        [15]: Compressed size 11 bytes
Compressing 32768 bytes... (input file size: 0)
        [01]: Compressed size 32777 bytes
        [02]: Compressed size 19670 bytes
        [03]: Compressed size 10931 bytes
        [04]: Compressed size 5792 bytes
        [05]: Compressed size 2987 bytes
        [06]: Compressed size 1523 bytes
        [07]: Compressed size 773 bytes
        [08]: Compressed size 392 bytes
        [09]: Compressed size 200 bytes
        [10]: Compressed size 104 bytes
        [11]: Compressed size 56 bytes
        [12]: Compressed size 32 bytes
        [13]: Compressed size 20 bytes
        [14]: Compressed size 14 bytes
        [15]: Compressed size 11 bytes
Compressing 65536 bytes... (input file size: 0)
        [01]: Compressed size 65543 bytes
        [02]: Compressed size 39329 bytes
        [03]: Compressed size 21854 bytes
        [04]: Compressed size 11573 bytes
        [05]: Compressed size 5966 bytes
        [06]: Compressed size 3035 bytes
        [07]: Compressed size 1535 bytes
        [08]: Compressed size 773 bytes
        [09]: Compressed size 392 bytes
        [10]: Compressed size 200 bytes
        [11]: Compressed size 104 bytes
        [12]: Compressed size 56 bytes
        [13]: Compressed size 32 bytes
        [14]: Compressed size 20 bytes
        [15]: Compressed size 14 bytes
Compressing 131072 bytes... (input file size: 0)
        [01]: Compressed size 131081 bytes
        [02]: Compressed size 78653 bytes
        [03]: Compressed size 43700 bytes
        [04]: Compressed size 23141 bytes
        [05]: Compressed size 11924 bytes
        [06]: Compressed size 6059 bytes
        [07]: Compressed size 3059 bytes
        [08]: Compressed size 1541 bytes
        [09]: Compressed size 776 bytes
        [10]: Compressed size 392 bytes
        [11]: Compressed size 200 bytes
        [12]: Compressed size 104 bytes
        [13]: Compressed size 56 bytes
        [14]: Compressed size 32 bytes
        [15]: Compressed size 20 bytes
Compressing 262144 bytes... (input file size: 0)
        [01]: Compressed size 262151 bytes
        [02]: Compressed size 157295 bytes
        [03]: Compressed size 87389 bytes
        [04]: Compressed size 46271 bytes
        [05]: Compressed size 23840 bytes
        [06]: Compressed size 12107 bytes
        [07]: Compressed size 6107 bytes
        [08]: Compressed size 3071 bytes
        [09]: Compressed size 1541 bytes
        [10]: Compressed size 776 bytes
        [11]: Compressed size 392 bytes
        [12]: Compressed size 200 bytes
        [13]: Compressed size 104 bytes
        [14]: Compressed size 56 bytes
        [15]: Compressed size 32 bytes
Compressing 524288 bytes... (input file size: 0)
        [01]: Compressed size 524297 bytes
        [02]: Compressed size 314582 bytes
        [03]: Compressed size 174773 bytes
        [04]: Compressed size 92531 bytes
        [05]: Compressed size 47672 bytes
        [06]: Compressed size 24206 bytes
        [07]: Compressed size 12203 bytes
        [08]: Compressed size 6131 bytes
        [09]: Compressed size 3077 bytes
        [10]: Compressed size 1544 bytes
        [11]: Compressed size 776 bytes
        [12]: Compressed size 392 bytes
        [13]: Compressed size 200 bytes
        [14]: Compressed size 104 bytes
        [15]: Compressed size 56 bytes
Compressing 1048576 bytes... (input file size: 0)
        [01]: Compressed size 1048583 bytes
        [02]: Compressed size 629153 bytes
        [03]: Compressed size 349535 bytes
        [04]: Compressed size 185051 bytes
        [05]: Compressed size 95333 bytes
        [06]: Compressed size 48404 bytes
        [07]: Compressed size 24395 bytes
        [08]: Compressed size 12251 bytes
        [09]: Compressed size 6143 bytes
        [10]: Compressed size 3077 bytes
        [11]: Compressed size 1544 bytes
        [12]: Compressed size 776 bytes
        [13]: Compressed size 392 bytes
        [14]: Compressed size 200 bytes
        [15]: Compressed size 104 bytes
Compressing 2097152 bytes... (input file size: 0)
        [01]: Compressed size 2097161 bytes
        [02]: Compressed size 1258301 bytes
        [03]: Compressed size 699059 bytes
        [04]: Compressed size 370094 bytes
        [05]: Compressed size 190661 bytes
        [06]: Compressed size 96800 bytes
        [07]: Compressed size 48779 bytes
        [08]: Compressed size 24491 bytes
        [09]: Compressed size 12275 bytes
        [10]: Compressed size 6149 bytes
        [11]: Compressed size 3080 bytes
        [12]: Compressed size 1544 bytes
        [13]: Compressed size 776 bytes
        [14]: Compressed size 392 bytes
        [15]: Compressed size 200 bytes
Compressing 4194304 bytes... (input file size: 0)
        [01]: Compressed size 4194311 bytes
        [02]: Compressed size 2516591 bytes
        [03]: Compressed size 1398110 bytes
        [04]: Compressed size 740180 bytes
        [05]: Compressed size 381311 bytes
        [06]: Compressed size 193592 bytes
        [07]: Compressed size 97550 bytes
        [08]: Compressed size 48971 bytes
        [09]: Compressed size 24539 bytes
        [10]: Compressed size 12287 bytes
        [11]: Compressed size 6149 bytes
        [12]: Compressed size 3080 bytes
        [13]: Compressed size 1544 bytes
        [14]: Compressed size 776 bytes
        [15]: Compressed size 392 bytes
Compressing 8388608 bytes... (input file size: 0)
        [01]: Compressed size 8388617 bytes
        [02]: Compressed size 5033174 bytes
        [03]: Compressed size 2796212 bytes
        [04]: Compressed size 1480352 bytes
        [05]: Compressed size 762611 bytes
        [06]: Compressed size 387176 bytes
        [07]: Compressed size 195092 bytes
        [08]: Compressed size 97931 bytes
        [09]: Compressed size 49067 bytes
        [10]: Compressed size 24563 bytes
        [11]: Compressed size 12293 bytes
        [12]: Compressed size 6152 bytes
        [13]: Compressed size 3080 bytes
        [14]: Compressed size 1544 bytes
        [15]: Compressed size 776 bytes
Compressing 16777216 bytes... (input file size: 0)
        [01]: Compressed size 16777223 bytes
        [02]: Compressed size 10066337 bytes
        [03]: Compressed size 5592413 bytes
        [04]: Compressed size 2960693 bytes
        [05]: Compressed size 1525211 bytes
        [06]: Compressed size 774341 bytes
        [07]: Compressed size 390176 bytes
        [08]: Compressed size 195851 bytes
        [09]: Compressed size 98123 bytes
        [10]: Compressed size 49115 bytes
        [11]: Compressed size 24575 bytes
        [12]: Compressed size 12293 bytes
        [13]: Compressed size 6152 bytes
        [14]: Compressed size 3080 bytes
        [15]: Compressed size 1544 bytes
Compressing 33554432 bytes... (input file size: 0)
        [01]: Compressed size 33554441 bytes
        [02]: Compressed size 20132669 bytes
        [03]: Compressed size 11184821 bytes
        [04]: Compressed size 5921381 bytes
        [05]: Compressed size 3050411 bytes
        [06]: Compressed size 1548677 bytes
        [07]: Compressed size 780344 bytes
        [08]: Compressed size 391694 bytes
        [09]: Compressed size 196235 bytes
        [10]: Compressed size 98219 bytes
        [11]: Compressed size 49139 bytes
        [12]: Compressed size 24581 bytes
        [13]: Compressed size 12296 bytes
        [14]: Compressed size 6152 bytes
        [15]: Compressed size 3080 bytes
Compressing 67108864 bytes... (input file size: 0)
        [01]: Compressed size 67108871 bytes
        [02]: Compressed size 40265327 bytes
        [03]: Compressed size 22369631 bytes
        [04]: Compressed size 11842751 bytes
        [05]: Compressed size 6100814 bytes
        [06]: Compressed size 3097343 bytes
        [07]: Compressed size 1560680 bytes
        [08]: Compressed size 783380 bytes
        [09]: Compressed size 392459 bytes
        [10]: Compressed size 196427 bytes
        [11]: Compressed size 98267 bytes
        [12]: Compressed size 49151 bytes
        [13]: Compressed size 24581 bytes
        [14]: Compressed size 12296 bytes
        [15]: Compressed size 6152 bytes
Compressing 134217728 bytes... (input file size: 0)
        [01]: Compressed size 134217737 bytes
        [02]: Compressed size 80530646 bytes
        [03]: Compressed size 44739251 bytes
        [04]: Compressed size 23685491 bytes
        [05]: Compressed size 12201620 bytes
        [06]: Compressed size 6194675 bytes
        [07]: Compressed size 3121352 bytes
        [08]: Compressed size 1566752 bytes
        [09]: Compressed size 784907 bytes
        [10]: Compressed size 392843 bytes
        [11]: Compressed size 196523 bytes
        [12]: Compressed size 98291 bytes
        [13]: Compressed size 49157 bytes
        [14]: Compressed size 24584 bytes
        [15]: Compressed size 12296 bytes
Compressing 268435456 bytes... (input file size: 0)
        [01]: Compressed size 268435463 bytes
        [02]: Compressed size 161061281 bytes
        [03]: Compressed size 89478494 bytes
        [04]: Compressed size 47370971 bytes
        [05]: Compressed size 24403232 bytes
        [06]: Compressed size 12389339 bytes
        [07]: Compressed size 6242693 bytes
        [08]: Compressed size 3133496 bytes
        [09]: Compressed size 1569806 bytes
        [10]: Compressed size 785675 bytes
        [11]: Compressed size 393035 bytes
        [12]: Compressed size 196571 bytes
        [13]: Compressed size 98303 bytes
        [14]: Compressed size 49157 bytes
        [15]: Compressed size 24584 bytes
Compressing 536870912 bytes... (input file size: 0)
        [01]: Compressed size 536870921 bytes
        [02]: Compressed size 322122557 bytes
        [03]: Compressed size 178956980 bytes
        [04]: Compressed size 94741934 bytes
        [05]: Compressed size 48806456 bytes
        [06]: Compressed size 24778667 bytes
        [07]: Compressed size 12485381 bytes
        [08]: Compressed size 6266984 bytes
        [09]: Compressed size 3139604 bytes
        [10]: Compressed size 1571339 bytes
        [11]: Compressed size 786059 bytes
        [12]: Compressed size 393131 bytes
        [13]: Compressed size 196595 bytes
        [14]: Compressed size 98309 bytes
        [15]: Compressed size 49160 bytes
Compressing 1073741824 bytes... (input file size: 0)
        [01]: Compressed size 1073741831 bytes
        [02]: Compressed size 644245103 bytes
        [03]: Compressed size 357913949 bytes
        [04]: Compressed size 189483860 bytes
        [05]: Compressed size 97612901 bytes
        [06]: Compressed size 49557323 bytes
        [07]: Compressed size 24970751 bytes
        [08]: Compressed size 12533960 bytes
        [09]: Compressed size 6279200 bytes
        [10]: Compressed size 3142667 bytes
        [11]: Compressed size 1572107 bytes
        [12]: Compressed size 786251 bytes
        [13]: Compressed size 393179 bytes
        [14]: Compressed size 196607 bytes
        [15]: Compressed size 98309 bytes
```
